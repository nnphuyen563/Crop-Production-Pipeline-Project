{{
    config(
        materialized='table'
    )
}}
with product as (
    select *
    from {{ ref("fact_production_item_group") }}
)
select
    continent,
    area,
    item,
    item_group,
    element,
    y1961, y1962, y1963, y1964, y1965, y1966, y1967, y1968, y1969, y1970, 
    y1971, y1972, y1973, y1974, y1975, y1976, y1977, y1978, y1979, y1980, 
    y1981, y1982, y1983, y1984, y1985, y1986, y1987, y1988, y1989, y1990, 
    y1991, y1992, y1993, y1994, y1995, y1996, y1997, y1998, y1999, y2000, 
    y2001, y2002, y2003, y2004, y2005, y2006, y2007, y2008, y2009, y2010, 
    y2011, y2012, y2013, y2014, y2015, y2016, y2017, y2018, y2019,
    (COALESCE(y1961, 0) + COALESCE(y1962, 0) + COALESCE(y1963, 0) + COALESCE(y1964, 0) + COALESCE(y1965, 0) + COALESCE(y1966, 0) + COALESCE(y1967, 0) + COALESCE(y1968, 0) + COALESCE(y1969, 0) + COALESCE(y1970, 0) 
    + COALESCE(y1971, 0) + COALESCE(y1972, 0) + COALESCE(y1973, 0) + COALESCE(y1974, 0) + COALESCE(y1975, 0) + COALESCE(y1976, 0) + COALESCE(y1977, 0) + COALESCE(y1978, 0) + COALESCE(y1979, 0) + COALESCE(y1980, 0) 
    + COALESCE(y1981, 0) + COALESCE(y1982, 0) + COALESCE(y1983, 0) + COALESCE(y1984, 0) + COALESCE(y1985, 0) + COALESCE(y1986, 0) + COALESCE(y1987, 0) + COALESCE(y1988, 0) + COALESCE(y1989, 0) + COALESCE(y1990, 0) 
    + COALESCE(y1991, 0) + COALESCE(y1992, 0) + COALESCE(y1993, 0) + COALESCE(y1994, 0) + COALESCE(y1995, 0) + COALESCE(y1996, 0) + COALESCE(y1997, 0) + COALESCE(y1998, 0) + COALESCE(y1999, 0) + COALESCE(y2000, 0) 
    + COALESCE(y2001, 0) + COALESCE(y2002, 0) + COALESCE(y2003, 0) + COALESCE(y2004, 0) + COALESCE(y2005, 0) + COALESCE(y2006, 0) + COALESCE(y2007, 0) + COALESCE(y2008, 0) + COALESCE(y2009, 0) + COALESCE(y2010, 0) 
    + COALESCE(y2011, 0) + COALESCE(y2012, 0) + COALESCE(y2013, 0) + COALESCE(y2014, 0) + COALESCE(y2015, 0) + COALESCE(y2016, 0) + COALESCE(y2017, 0) + COALESCE(y2018, 0) + COALESCE(y2019, 0)) as total
from product
